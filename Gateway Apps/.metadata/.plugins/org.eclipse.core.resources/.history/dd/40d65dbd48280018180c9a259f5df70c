package org.nandor.spark;

import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Random;

import org.apache.spark.SparkConf;
import org.apache.spark.api.java.JavaSparkContext;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;
import org.json.simple.parser.ParseException;

public class Testing{

	public static JSONObject readJson(String file){
		JSONParser parser = new JSONParser();
		JSONObject a = new JSONObject();
		try {
			a = (JSONObject) parser.parse(new FileReader(file));
		} catch (IOException | ParseException e) {
			e.printStackTrace();
		}
		return a;
	}
	
	public static void writeJson(String file,JSONObject json){
		FileWriter f;
		try {
			f = new FileWriter(file);
			f.write(json.toJSONString());
			f.flush();
			f.close();
		} catch (IOException e) {
			e.printStackTrace();
		}
	}
	

	public static void main(String[] args) {

		Fog f = Methods.InitFog(6,0);//Cluster Count, Cloud Gw Count
	    //Fog f=Exporter.readJsonFog(readJson("C:/Users/Nandor/Documents/FogOfThings/Gateway Apps/spark-test/src/main/java/org/nandor/spark/deploy-W.json"));
		//writeJson("C:/Users/Nandor/Documents/FogOfThings/Gateway Apps/spark-test/src/main/java/org/nandor/spark/deploy-W.json",Exporter.writeJsonFog(f));
		 
		//Clustering(f);
		// CLustering based GA
		//GAClusStuff(f, 100, 100);//Fog, Generation Size, Generation Count
		
	    //DisplayData(f);
		//Global Optimization
		Methods.GAGlobalStuff(f, 30, 200);//Fog, Generation Size, Generation Cunt
		
		//ExhaustiveClusStuff(f);
		long start=System.currentTimeMillis();
		Methods.Clustering(f,1,6);
		Methods.ResourceAllocation(f);
		Methods.GAClusStuff(f, 30, 200);
		Methods.ExhaustiveClusStuff(f);
		//Clustering and then All sorts of Optimization
		Methods.clusteredDeployment(f, 1,6,30, 200);
		
		//writeJson("C:/Users/Nandor/Documents/FogOfThings/Gateway Apps/spark-test/src/main/java/org/nandor/spark/deploy-W.json",Exporter.writeJsonFog(f));
	  }
	
}
