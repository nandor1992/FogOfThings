package org.nandor.spark;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;

public class WeightedCls extends Clustering{

	public WeightedCls(Fog f) {
		super(f);
	}
	//Connections in a way that is not directional
	public Map<Integer,List<Integer>> getConnections(){
		Map<Integer,List<Integer>> nodes = new HashMap<>();
		for (Integer p: this.fog.getApps().keySet()){
			if (nodes.containsKey(p)){
				nodes.get(p).addAll(this.fog.getApps().get(p).getApps().keySet());
			}else{
				List<Integer> point = new ArrayList<>();
				point.addAll(this.fog.getApps().get(p).getApps().keySet());
				nodes.put(p, point);
			}
			for (Integer pBack: this.fog.getApps().get(p).getApps().keySet()){
					if (nodes.containsKey(pBack)){
						nodes.get(pBack).add(p);
					}else{
						List<Integer> pointBack = new ArrayList<>();
						pointBack.add(p);
						nodes.put(pBack, pointBack);
					}
				}
		}
		for (Integer p: nodes.keySet()){
			List<Integer> deDupStringList = new ArrayList<>(new HashSet<>(nodes.get(p)));
			nodes.put(p, deDupStringList);
			
		}
		//System.out.println(nodes);
		return nodes;
	}

	public void Map<String,Float> getSimilarities(Integer p1,Integer p2){	
		//Connection Distance
		
		//Resource Location share
		//Constraint Component
		//Msg Rate
		//Unit Load
		//Utility Weights ratio
		//Requirements
	}
}
